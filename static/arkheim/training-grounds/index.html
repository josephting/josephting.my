<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arkheim Training Grounds Calculator</title>
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="mt-10">
    <div class="lg:container lg:mx-auto">
        <h1 class="font-sans font-bold text-4xl tracking-tighter subpixel-antialiased mb-8">Arkheim Training Grounds Calculator</h1>
        <form>
            <div class="flex space-x-8">
                <div class="flex-1">
                    <p class="text-2xl">Warlord 1</p>
                    <div class="mb-4">
                        <p class="text-xl">Slot 1</p>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w1-count1">Max Unit Count</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w1-count1" name="w1-count1" type="number" min="0">
                        </div>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w1-str1">Unit Strength</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w1-str1" name="w1-str1" type="number" min="0">
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 2</p>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w1-count2">Max Unit Count</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w1-count2" name="w1-count2" type="number" min="0">
                        </div>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w1-str2">Unit Strength</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w1-str2" name="w1-str2" type="number" min="0">
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 3</p>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w1-count3">Max Unit Count</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w1-count3" name="w1-count3" type="number" min="0">
                        </div>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w1-str3">Unit Strength</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w1-str3" name="w1-str3" type="number" min="0">
                        </div>
                    </div>
                </div>
                <div class="flex-1">
                    <p class="text-2xl">Warlord 2</p>
                    <div class="mb-4">
                        <p class="text-xl">Slot 1</p>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w2-count1">Max Unit Count</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w2-count1" name="w2-count1" type="number" min="0">
                        </div>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w2-str1">Unit Strength</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w2-str1" name="w2-str1" type="number" min="0">
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 2</p>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w2-count2">Max Unit Count</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w2-count2" name="w2-count2" type="number" min="0">
                        </div>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w2-str2">Unit Strength</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w2-str2" name="w2-str2" type="number" min="0">
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 3</p>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w2-count3">Max Unit Count</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w2-count3" name="w2-count3" type="number" min="0">
                        </div>
                        <div class="mb-2">
                            <label class="block text-gray-700 text-sm font-bold mb-2" for="w2-str3">Unit Strength</label>
                            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="w2-str3" name="w2-str3" type="number" min="0">
                        </div>
                    </div>
                </div>
            </div>
        </form>
        <div class="block">
            <h3 class="font-sans font-bold text-2xl tracking-tighter subpixel-antialiased mb-8">Recommended Unit Count</h3>
            <div class="flex space-x-8">
                <div class="flex-1">
                    <p class="text-2xl">Warlord 1</p>
                    <div class="mb-4">
                        <p class="text-xl">Slot 1</p>
                        <p id="rw1-slot1"></p>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 2</p>
                        <p id="rw1-slot2"></p>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 3</p>
                        <p id="rw1-slot3"></p>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Total Strength</p>
                        <p id="rw1-total"></p>
                    </div>
                </div>
                <div class="flex-1">
                    <p class="text-2xl">Warlord 2</p>
                    <div class="mb-4">
                        <p class="text-xl">Slot 1</p>
                        <p id="rw2-slot1"></p>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 2</p>
                        <p id="rw2-slot2"></p>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Slot 3</p>
                        <p id="rw2-slot3"></p>
                    </div>
                    <div class="mb-4">
                        <p class="text-xl">Total Strength</p>
                        <p id="rw2-total"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const getValues = function () {
            const formData = Object.fromEntries(Array.from(new FormData(document.querySelector('form')).entries()).map(v => [v[0], parseInt(v[1])]));
            localStorage.setItem('formData', JSON.stringify(formData));
            return formData;
        };
        const calculate = function (formData) {
            var result = {
                w1c1: NaN,
                w1s1: NaN,
                w1c2: NaN,
                w1s2: NaN,
                w1c3: NaN,
                w1s3: NaN,
                w2c1: NaN,
                w2s1: NaN,
                w2c2: NaN,
                w2s2: NaN,
                w2c3: NaN,
                w2s3: NaN
            };
            if (isRequiredFilled(formData)) {
                ['1', '2', '3'].forEach((v) => {
                    if (isWarlord1Stronger(formData, v)) {
                        var a = '2', b = '1';
                    } else {
                        var a = '1', b = '2';
                    }
                    var update = {};
                    update[`w${a}c${v}`] = formData[`w${a}-count${v}`];
                    update[`w${a}s${v}`] = formData[`w${a}-count${v}`] * formData[`w${a}-str${v}`];
                    update[`w${b}c${v}`] = Math.round(update[`w${a}s${v}`] / formData[`w${b}-str${v}`]);
                    update[`w${b}s${v}`] = update[`w${b}c${v}`] * formData[`w${b}-str${v}`];
                    Object.assign(result, update);
                });
                updateResult(result);
            }
        };
        const isRequiredFilled = (formData) => {
            var isAllFilled = true;
            return Object.entries(formData).filter(v => isNaN(v[1])).length === 0;
        };
        const isWarlord1Stronger = (formData, index) => {
            return formData[`w1-str${index}`] * formData[`w1-count${index}`] > formData[`w2-str${index}`] * formData[`w2-count${index}`];
        };
        const updateResult = (result) => {
            ['1', '2'].forEach(wl => {
                var totalStrength = 0;
                ['1', '2', '3'].forEach(slot => {
                    totalStrength += result[`w${wl}s${slot}`];
                    document.querySelector(`#rw${wl}-slot${slot}`).innerHTML = result[`w${wl}c${slot}`].toLocaleString() + ' (' + result[`w${wl}s${slot}`].toLocaleString() + ')';
                });
                document.querySelector(`#rw${wl}-total`).innerHTML = totalStrength.toLocaleString();
            });
        };
        document.querySelector('form').addEventListener('keyup', function (e) {
            var formData = getValues();
            calculate(formData);
        });
        window.addEventListener('load', () => {
            var formData = JSON.parse(localStorage.getItem('formData') || '{}');
            calculate(formData);
            for (var i of Object.entries(formData)) {
                document.querySelector(`#${i[0]}`).value = i[1] ? i[1].toString() : '';
            }
        });
    </script>
</body>
</html>
